{% extends "base.html" %}

{% block content %}
{% if product %}
    <h1 class="text-2xl font-bold mb-4">Edit Product #{{ product.id }}</h1>
{% else %}
    <h1 class="text-2xl font-bold mb-4">Add New Product</h1>
{% endif %}

<div class="bg-white p-6 rounded shadow max-w-2xl">
    <form method="post" enctype="multipart/form-data">
        <label class="block text-sm mb-1">Name</label>
        <input type="text" name="name" class="w-full border px-2 py-1 mb-3"
               value="{{ product.name if product else '' }}" required>

        <label class="block text-sm mb-1">Description</label>
        <textarea name="description" class="w-full border px-2 py-1 mb-3" rows="3">{{ product.description if product else '' }}</textarea>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
            <div>
                <label class="block text-sm mb-1">Brand</label>
                <input type="text" name="brand" class="w-full border px-2 py-1 mb-3"
                       value="{{ product.brand if product else '' }}">
            </div>
            <div>
                <label class="block text-sm mb-1">Size</label>
                <input type="text" name="size" class="w-full border px-2 py-1 mb-3"
                       value="{{ product.size if product else '' }}">
            </div>
            <div>
                <label class="block text-sm mb-1">Colour</label>
                <input type="text" name="color" class="w-full border px-2 py-1 mb-3"
                       value="{{ product.color if product else '' }}">
            </div>
        </div>

        <label class="block text-sm mb-1">Price (â‚¹)</label>
        <input type="number" step="0.01" name="price" class="w-full border px-2 py-1 mb-3"
               value="{{ product.price if product else '' }}" required>

        <label class="block text-sm mb-1">Category</label>
        <select name="category_id" class="w-full border px-2 py-1 mb-3" required>
            {% for c in categories %}
                <option value="{{ c.id }}"
                    {% if product and product.category_id == c.id %}selected{% endif %}>
                    {{ c.name }}
                </option>
            {% endfor %}
        </select>

        <label class="block text-sm mb-1">Image</label>
        <input type="file" name="image" class="w-full mb-3">

        {% if product and product.image_filename %}
            <p class="mb-3 text-sm">Current image:</p>
            <img src="{{ url_for('static', filename='uploads/' ~ product.image_filename) }}"
                 class="h-32 mb-3">
        {% endif %}

        {% if product %}
            <label class="inline-flex items-center mb-3">
                <input type="checkbox" name="is_active" value="1" class="mr-2"
                       {% if product.is_active %}checked{% endif %}>
                Active
            </label>
        {% endif %}

        <div class="mt-4 flex space-x-3">
            <button class="bg-gray-900 text-white px-4 py-2 rounded">
                Save
            </button>
            <a href="{{ url_for('admin_products') }}" class="px-4 py-2 rounded border">
                Cancel
            </a>
        </div>
    </form>
</div>
{% endblock %}
